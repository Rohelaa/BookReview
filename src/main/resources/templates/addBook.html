<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<meta charset="utf-8">
<title>Add a new book</title>
</head>
<body>
	<!-- Google CDN (content delivery network) -->
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

	<!-- Kokeilua. Painiketta klikkaamalla aukeaisi syöttökenttä, johon voisi syöttää uuden kategorian nimen -->

	<script type="text/javascript">
		$(document).ready(function() {

			$('#createNew').click(function() {
				$('#categoryCreator').css("visibility", "visible");

				// ehkäisee selaimen oletustoiminnan
				// ilman tätä painikkeen klikkaus vie takaisin kirjalista-näkymään

				return false;
			});

		});
	</script>


	<!-- <script type="text/javascript">
		function createNewCategory() {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					document.getElementById("categoryCreator").innerHTML =
						'<label>Create a new category:</label>' + '<input type="text" th:field="${category.name}" /><br />';
				}
			}
			/* xhttp.open("GET", "asd", true); */
			xhttp.send();
		}
	</script> -->

	<form th:object="${book}" action="#" method="post"
		th:action="@{saveBook}">
		<table>
			<tr>
				<td>Title: <input type="text" th:field="*{title}" /></td>
				<td th:if="${#fields.hasErrors('title')}" th:errors="*{title}">
					Error
				</td>
			</tr>
				<!-- <br /> --> 
			<tr>
				<td><label>Author: <input th:field="*{author}" /></label><br /></td>
				<td th:if="${#fields.hasErrors('author')}" th:errors="*{author}">Error</td>
			</tr>
			<tr>
				<td><label>Year: <input th:field=*{year} /></label><br /> </td>
				<td th:if="${#fields.hasErrors('year')}" th:errors="*{year}">Error</td>
			</tr>
			<tr>
				<td>
					<label>Category:
					<select th:field="*{category}">
						<option value=""></option>
						<option th:each="category : ${categories}"
							th:text="${category.name}" th:value="${category.id}"></option>
						<!-- <option onselect="createNewCategory()" value="new">Create new</option> -->
						<!-- <option value="new">Create new</option> -->
					</select></label> <br />
				</td>
				<td th:if="${#fields.hasErrors('category')}" th:errors="*{category}">Error</td>
			</tr>
		</table>
		
			<button id="createNew">Create new</button>

			<!-- Kenttä, joka tulisi näkyviin painiketta klikkaamalla -->
			<!-- inline CSS  -->
			<div id="categoryCreator" style="visibility: hidden;">
				<label>Create a new category: <input type="text"
					th:field="${category.name}" /></label><br />
			</div>

			<input type="submit" value="Add" />
		
	</form>
</body>
</html>